<% title t('.page_title') %>
<% step_header(path: applications_path) %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-l"><%= t('.heading') %></h1>
    <%= govuk_error_summary(@form_object) %>
    <%= step_form @form_object do |f| %>
      <%= f.fields_for :defendants do |d| %>
        <% index = d.index + 1 %>
        <%= d.govuk_fieldset legend: { text: t(".#{'main_' if d.object.main}defendant_field_set", index: d.index) }, class: 'moj-add-another__item' do %>
          <%= d.button t('.remove_button', index:), type: :submit, value: '1', name: d.field_name(:_destroy, index: d.id),
                        class: %w[govuk-button govuk-button--secondary moj-add-another__remove-button],
                        data: { module: 'govuk-button' } if @form_object.show_destroy? && !d.object.main %>

          <%= d.hidden_field :main %>
          <%= d.hidden_field :position %>
          <%= d.govuk_text_field :full_name, maxlength_enabled: true, label: { text: t("helpers.label.#{f.object_name}.full_name", index:) } %>
          <% if d.object.maat_required? %>
            <%= d.govuk_text_field :maat, maxlength_enabled: true, label: { text:  t("helpers.label.#{f.object_name}.maat", index:) } %>
          <% end %>


        <% end %>
      <% end %>

      <%= f.button t('.add_button'), type: :submit, name: :add_defendant,
                   class: %w[govuk-button govuk-button--secondary govuk-!-margin-bottom-8],
                   data: { module: 'govuk-button' } %>

      <%= f.continue_button %>
    <% end %>
  </div>
</div>


